"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[275],{7522:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>h});var a=t(9901);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=a.createContext({}),p=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=p(e.components);return a.createElement(l.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(t),m=i,h=d["".concat(l,".").concat(m)]||d[m]||u[m]||r;return t?a.createElement(h,o(o({ref:n},c),{},{components:t})):a.createElement(h,o({ref:n},c))}));function h(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,o=new Array(r);o[0]=m;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[d]="string"==typeof e?e:i,o[1]=s;for(var p=2;p<r;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},6551:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>k,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var a=t(3223),i=(t(9901),t(7522));const r={sidebar_label:"@twa.js/sdk-react",sidebar_position:5},o="@twa.js/sdk-react",s={unversionedId:"libraries/twa-js-sdk-react",id:"libraries/twa-js-sdk-react",title:"@twa.js/sdk-react",description:"React bindings for the client SDK. It includes hooks, components, and other useful tools that enable the use of React alongside the Web Apps client SDK. It automatically tracks changes to SDK components.",source:"@site/docs/libraries/twa-js-sdk-react.mdx",sourceDirName:"libraries",slug:"/libraries/twa-js-sdk-react",permalink:"/docs/libraries/twa-js-sdk-react",draft:!1,editUrl:"https://github.com/twa-dev/docs/tree/master/docs/libraries/twa-js-sdk-react.mdx",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_label:"@twa.js/sdk-react",sidebar_position:5},sidebar:"sidebar",previous:{title:"WebApp",permalink:"/docs/libraries/twa-js-sdk/components/web-app"},next:{title:"init-data-golang",permalink:"/docs/libraries/init-data-golang"}},l={},p=[{value:"Installation",id:"installation",level:2},{value:"Initialization",id:"initialization",level:2},{value:"Using SDK provider",id:"using-sdk-provider",level:3},{value:"Getting SDK context",id:"getting-sdk-context",level:3},{value:"When init is done",id:"when-init-is-done",level:3},{value:"Hooks and HOCs",id:"hooks-and-hocs",level:2},{value:"Launch parameters",id:"launch-parameters",level:3},{value:"Other",id:"other",level:3}],c=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",n)},d=c("LibraryBadges"),u=c("NpmInstall"),m={toc:p},h="wrapper";function k(e){let{components:n,...t}=e;return(0,i.kt)(h,(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"twajssdk-react"},"@twa.js/sdk-react"),(0,i.kt)("p",null,"React bindings for the ",(0,i.kt)("a",{parentName:"p",href:"twa-js-sdk/about"},"client SDK"),". It includes hooks, components, and other useful tools that enable the use of React alongside the Web Apps client SDK. It automatically tracks changes to SDK components."),(0,i.kt)(d,{pkg:"@twa.js/sdk-react",mdxType:"LibraryBadges"}),(0,i.kt)("h2",{id:"installation"},"Installation"),(0,i.kt)("p",null,"Before anything else, it is assumed that you have already installed the ",(0,i.kt)("inlineCode",{parentName:"p"},"react")," package, as it is a peer dependency of this package. The installation of the SDK itself is not required, as it is already included in ",(0,i.kt)("inlineCode",{parentName:"p"},"@twa.js/sdk-react"),"."),(0,i.kt)(u,{pkg:"@twa.js/sdk-react",mdxType:"NpmInstall"}),(0,i.kt)("h2",{id:"initialization"},"Initialization"),(0,i.kt)("h3",{id:"using-sdk-provider"},"Using SDK provider"),(0,i.kt)("p",null,"According to the ",(0,i.kt)("inlineCode",{parentName:"p"},"@twa.js/sdk")," ",(0,i.kt)("a",{parentName:"p",href:"twa-js-sdk/about"},"documentation"),", it consists of a set of components that are not initialized by default. Developers are responsible for creating these components themselves. However, the SDK provides the ",(0,i.kt)("inlineCode",{parentName:"p"},"init")," function, which simplifies the process of creating the components and using the standard TWA flow. It handles all the necessary steps for developers."),(0,i.kt)("p",null,"To make the SDK functionality available to the application and allow the initialization of newly created components, we need to use the ",(0,i.kt)("inlineCode",{parentName:"p"},"SDKProvider")," component."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"jsx",jsx:!0},"import React from 'react';\nimport { SDKProvider } from '@twa.js/sdk-react';\n\nfunction Root() {\n  return (\n    <SDKProvider>\n      <div>My application!</div>\n    </SDKProvider>\n  );\n}\n")),(0,i.kt)("p",null,"Internally, the ",(0,i.kt)("inlineCode",{parentName:"p"},"SDKProvider")," utilizes the ",(0,i.kt)("inlineCode",{parentName:"p"},"init")," function from ",(0,i.kt)("inlineCode",{parentName:"p"},"@twa.js/sdk"),". It accepts an optional list of parameters through the ",(0,i.kt)("inlineCode",{parentName:"p"},"initOptions")," property, which is described ",(0,i.kt)("a",{parentName:"p",href:"twa-js-sdk/about#init"},"here"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"jsx",jsx:!0},"import React from 'react';\nimport { SDKProvider, InitOptions } from '@twa.js/sdk-react';\n\n/**\n * Root component for the whole project.\n */\nexport function Root() {\n  const options: InitOptions = {\n    acceptScrollbarStyle: true,\n    checkCompat: true,\n    debug: true\n  };\n\n  return (\n    <SDKProvider initOptions={options}>\n      <div>My application!</div>\n    </SDKProvider>\n  );\n}\n")),(0,i.kt)("p",null,"Most of the time, there is no need to use ",(0,i.kt)("inlineCode",{parentName:"p"},"initOptions")," unless you have specific logic in your application. Typically, the SDK handles everything necessary for developers, so there is no need for additional configuration."),(0,i.kt)("h3",{id:"getting-sdk-context"},"Getting SDK context"),(0,i.kt)("p",null,"By using the ",(0,i.kt)("inlineCode",{parentName:"p"},"SDKProvider")," component, the child elements are able to utilize the ",(0,i.kt)("inlineCode",{parentName:"p"},"useSDK")," hook (or the ",(0,i.kt)("inlineCode",{parentName:"p"},"withSDK")," higher-order component) to access core SDK information."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"jsx",jsx:!0},"import React from 'react';\nimport { SDKProvider, SDKContext, useSDK, withSDK } from '@twa.js/sdk-react';\n\nfunction App() {\n  const sdk = useSDK();\n\n  // Here, we can use SDK information.\n\n  return <div>My application!</div>;\n}\n\n// or\n\ninterface Props {\n  sdk: SDKContext\n}\n\nfunction AppPure({ sdk }: Props) {\n  return <div>My application!</div>;\n}\n\nconst AppWrapped = withSDK(AppPure);\n\nfunction Root() {\n  return (\n    <SDKProvider>\n      <App/>\n      {/* or */}\n      <AppWrapped/>\n    </SDKProvider>\n  );\n}\n")),(0,i.kt)("p",null,"Let's enhance the previous example and introduce crucial logic associated with the SDK lifecycle:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"jsx",jsx:!0},"import React, { PropsWithChildren, useEffect } from 'react';\nimport { SDKProvider, useSDK, useBackButton, useWebApp } from '@twa.js/sdk-react';\n\n/**\n * Part of the application which doesn't know anything about SDK initialization\n * and which should be rendered only in case, SDK is already initialized and\n * could provide Web Apps components.\n */\nfunction App() {\n  const backButton = useBackButton();\n  const webApp = useWebApp();\n\n  // When App is attached to DOM, lets show back button and\n  // add \"click\" event handler, which should close current application.\n  useEffect(() => {\n    const listener = () => webApp.close();\n    backButton.on('click', listener);\n    backButton.show();\n\n    return () => {\n      backButton.off('click', listener);\n      backButton.hide();\n    };\n    // We know, that backButton and webApp will never change,\n    // but let's follow React rules.\n  }, [backButton, webApp]);\n\n  return <div>My application!</div>;\n}\n\n/**\n * This component is the layer controlling the application display. It displays\n * application in case, the SDK is initialized, displays an error if something\n * went wrong, and a loader if the SDK is warming up.\n */\nfunction Loader({children}: PropsWithChildren<{}>) {\n  const {didInit, components, error} = useSDK();\n\n  // There were no calls of SDK's init function. It means, we did not\n  // even try to do it.\n  if (!didInit) {\n    return <div>SDK init function is not yet called.</div>;\n  }\n\n  // Error occurred during SDK init.\n  if (error !== null) {\n    return <div>Something went wrong.</div>;\n  }\n\n  // If components is null, it means, SDK is not ready at the\n  // moment and currently initializing. Usually, it takes like\n  // several milliseconds or something like that, but we should\n  // have this check.\n  if (components === null) {\n    return <div>Warming up SDK.</div>;\n  }\n\n  // Safely render application.\n  return <>{children}</>;\n}\n\n/**\n * Root component of the whole project.\n */\nexport function Root() {\n  return (\n    <SDKProvider>\n      <Loader>\n        <App/>\n      </Loader>\n    </SDKProvider>\n  );\n}\n")),(0,i.kt)("p",null,"You might wonder why we need a component like ",(0,i.kt)("inlineCode",{parentName:"p"},"Loader"),". The reason is that the SDK initialization process is asynchronous. Some of its components need to send requests to the Telegram application to fetch their current state. Due to this, we cannot determine the required properties for these components until the initialization is completed."),(0,i.kt)("p",null,"As a result, all hooks that return component instances will throw an error because they cannot retrieve the necessary component from the ",(0,i.kt)("inlineCode",{parentName:"p"},"components")," property. Therefore, these hooks should not be called until the SDK is fully initialized."),(0,i.kt)("h3",{id:"when-init-is-done"},"When init is done"),(0,i.kt)("p",null,"Once the initialization is successfully completed, developers should call the ",(0,i.kt)("inlineCode",{parentName:"p"},"webApp.ready")," function. This function notifies the Telegram application that the current Web App is ready to be displayed."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"jsx",jsx:!0},"import React, { useEffect } from 'react';\nimport { useWebApp } from '@twa.js/sdk-react';\n\nfunction App() {\n  const webApp = useWebApp();\n\n  useEffect(() => {\n    webApp.ready();\n  }, [webApp]);\n\n  return <div>Here is my App</div>;\n}\n")),(0,i.kt)("h2",{id:"hooks-and-hocs"},"Hooks and HOCs"),(0,i.kt)("h3",{id:"launch-parameters"},"Launch parameters"),(0,i.kt)("p",null,"There may be cases where a developer needs to retrieve launch parameters without initializing the entire SDK. For example, they might want to access current theme parameters stored in ",(0,i.kt)("inlineCode",{parentName:"p"},"window.location"),". In such cases, SDK initialization may not be necessary."),(0,i.kt)("p",null,"To retrieve Web App launch parameters, the ",(0,i.kt)("inlineCode",{parentName:"p"},"useLaunchParams")," hook (or the ",(0,i.kt)("inlineCode",{parentName:"p"},"withLaunchParams")," higher-order component) can be used."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"jsx",jsx:!0},"import React from 'react';\nimport { useLaunchParams, withLaunchParams, LaunchParams } from '@twa.js/sdk-react';\n\nfunction DisplayLaunchParams() {\n  const launchParams = useLaunchParams();\n\n  return (\n    <pre>\n      <code>{JSON.stringify(launchParams, null, ' ')}</code>\n    </pre>\n  );\n}\n\n// or\n\ninterface Props {\n  launchParams: LaunchParams;\n}\n\nfunction DisplayLaunchParamsPure({launchParams}: Props) {\n  return (\n    <pre>\n      <code>{JSON.stringify(launchParams, null, ' ')}</code>\n    </pre>\n  );\n}\n\nconst DisplayLaunchParamsWrapped = withLaunchParams(DisplayLaunchParams);\n")),(0,i.kt)("p",null,"It will return the result of the ",(0,i.kt)("a",{parentName:"p",href:"twa-js-sdk/about#launch-parameters"},(0,i.kt)("inlineCode",{parentName:"a"},"retrieveLaunchParams"))," function."),(0,i.kt)("h3",{id:"other"},"Other"),(0,i.kt)("p",null,"The library provides a collection of simple hooks and higher-order components (HOCs) for each SDK component. The returned instances of these components remain the same, but force updates will be triggered if any changes occur in a component."),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"If you are using higher-order components (HOCs), it's important to note that the passed components will always be the same instances. This can cause issues with React's ",(0,i.kt)("inlineCode",{parentName:"p"},"PureComponent")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"memo")," components, as they won't detect any changes in the component references. To avoid problems, refrain from creating new component instances, as it can disrupt event listeners established during the SDK initialization process.")),(0,i.kt)("p",null,"List of hooks and HOCs of components:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"useBackButton")," (",(0,i.kt)("inlineCode",{parentName:"li"},"withBackButton"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"useBridge")," (",(0,i.kt)("inlineCode",{parentName:"li"},"withBridge"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"useClosingConfirmation")," (",(0,i.kt)("inlineCode",{parentName:"li"},"withClosingConfirmation"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"useHapticFeedback")," (",(0,i.kt)("inlineCode",{parentName:"li"},"withHapticFeedback"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"useInitData")," (",(0,i.kt)("inlineCode",{parentName:"li"},"withInitData"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"useLayout")," (",(0,i.kt)("inlineCode",{parentName:"li"},"withLayout"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"useMainButton")," (",(0,i.kt)("inlineCode",{parentName:"li"},"withMainButton"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"usePopup")," (",(0,i.kt)("inlineCode",{parentName:"li"},"withPopup"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"useQRScanner")," (",(0,i.kt)("inlineCode",{parentName:"li"},"withQRScanner"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"useThemeParams")," (",(0,i.kt)("inlineCode",{parentName:"li"},"withThemeParams"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"useViewport")," (",(0,i.kt)("inlineCode",{parentName:"li"},"withViewport"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"useWebApp")," (",(0,i.kt)("inlineCode",{parentName:"li"},"withWebApp"),")")))}k.isMDXComponent=!0}}]);